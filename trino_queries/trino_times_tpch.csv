select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from hive.default.lineitem_100 where l_shipdate <= '1998-09-16' group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;;100;select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from hive.default.part_100, hive.default.supplier_100, hive.default.partsupp_100, hive.default.nation_100, hive.default.region_100 where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = (  select   min(ps_supplycost)  from   hive.default.partsupp_100,   hive.default.supplier_100,   hive.default.nation_100,   hive.default.region_100  where   p_partkey = ps_partkey   and s_suppkey = ps_suppkey   and s_nationkey = n_nationkey   and n_regionkey = r_regionkey   and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey LIMIT 100;;100
select l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority from hive.default.customer_100 c join hive.default.orders_100 o on c.c_mktsegment = 'BUILDING' and c.c_custkey = o.o_custkey join hive.default.lineitem_100 l on l.l_orderkey = o.o_orderkey where o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate limit 10;;100;select o_orderpriority, count(*) as order_count from hive.default.orders_100 where date(o_orderdate) >= date '1996-10-01' and date(o_orderdate) < date '1996-10-01' + interval '3' month and exists (  select   *  from   hive.default.lineitem_100  where   l_orderkey = o_orderkey   and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority LIMIT 1;;100
select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from hive.default.customer_100, hive.default.orders_100, hive.default.lineitem_100, hive.default.supplier_100, hive.default.nation_100, hive.default.region_100 where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and date(o_orderdate) >= date '1997-01-01' and date(o_orderdate) < date '1997-01-01' + interval '1' year group by n_name order by revenue desc LIMIT 1;;100;select sum(l_extendedprice * l_discount) as revenue from hive.default.lineitem_100 where date(l_shipdate) >= date '1997-01-01' and date(l_shipdate) < date '1997-01-01' + interval '1' year and l_discount between 0.03 - 0.01 and 0.03 + 0.01 and l_quantity < 24 LIMIT 1;;100
select supp_nation, cust_nation, l_year, sum(volume) as revenue from (  select   n1.n_name as supp_nation,   n2.n_name as cust_nation,   extract(year from date(l_shipdate)) as l_year,   l_extendedprice * (1 - l_discount) as volume  from   hive.default.supplier_100,   hive.default.lineitem_100,   hive.default.orders_100,   hive.default.customer_100,   hive.default.nation_100 n1,   hive.default.nation_100 n2  where   s_suppkey = l_suppkey   and o_orderkey = l_orderkey   and c_custkey = o_custkey   and s_nationkey = n1.n_nationkey   and c_nationkey = n2.n_nationkey   and (    (n1.n_name = 'EGYPT' and n2.n_name = 'UNITED STATES')    or (n1.n_name = 'UNITED STATES' and n2.n_name = 'EGYPT')   )   and date(l_shipdate) between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year LIMIT 1;;100;select o_year, sum(case  when nation = 'EGYPT' then volume  else 0 end) / sum(volume) as mkt_share from (  select   extract(year from date(o_orderdate)) as o_year,   l_extendedprice * (1 - l_discount) as volume,   n2.n_name as nation  from   hive.default.part_100,   hive.default.supplier_100,   hive.default.lineitem_100,   hive.default.orders_100,   hive.default.customer_100,   hive.default.nation_100 n1,   hive.default.nation_100 n2,   hive.default.region_100  where   p_partkey = l_partkey   and s_suppkey = l_suppkey   and l_orderkey = o_orderkey   and o_custkey = c_custkey   and c_nationkey = n1.n_nationkey   and n1.n_regionkey = r_regionkey   and r_name = 'MIDDLE EAST'   and s_nationkey = n2.n_nationkey   and date(o_orderdate) between date '1995-01-01' and date '1996-12-31'   and p_type = 'PROMO BRUSHED COPPER' ) as all_nations group by o_year order by o_year LIMIT 1;;100
select nation, o_year, sum(amount) as sum_profit from (  select   n_name as nation,   extract(year from date(o_orderdate)) as o_year,   l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount  from   hive.default.part_100,   hive.default.supplier_100,   hive.default.lineitem_100,   hive.default.partsupp_100,   hive.default.orders_100,   hive.default.nation_100  where   s_suppkey = l_suppkey   and ps_suppkey = l_suppkey   and ps_partkey = l_partkey   and p_partkey = l_partkey   and o_orderkey = l_orderkey   and s_nationkey = n_nationkey   and p_name like '%yellow%' ) as profit group by nation, o_year order by nation, o_year desc LIMIT 1;;100;select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from hive.default.customer_100, hive.default.orders_100, hive.default.lineitem_100, hive.default.nation_100 where c_custkey = o_custkey and l_orderkey = o_orderkey and date(o_orderdate) >= date '1994-03-01' and date(o_orderdate) < date '1994-03-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc LIMIT 20;;100
select ps_partkey, sum(ps_supplycost * ps_availqty) as value from hive.default.partsupp_100, hive.default.supplier_100, hive.default.nation_100 where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'JAPAN' group by ps_partkey having  sum(ps_supplycost * ps_availqty) > (   select    sum(ps_supplycost * ps_availqty) * 0.0001   from    hive.default.partsupp_100,    hive.default.supplier_100,    hive.default.nation_100   where    ps_suppkey = s_suppkey    and s_nationkey = n_nationkey    and n_name = 'JAPAN'  ) order by value desc LIMIT 1;;100;select l_shipmode, sum(case  when o_orderpriority = '1-URGENT'   or o_orderpriority = '2-HIGH'   then 1  else 0 end) as high_line_count, sum(case  when o_orderpriority <> '1-URGENT'   and o_orderpriority <> '2-HIGH'   then 1  else 0 end) as low_line_count from hive.default.orders_100, hive.default.lineitem_100 where o_orderkey = l_orderkey and l_shipmode in ('TRUCK', 'REG AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and date(l_receiptdate) >= date '1994-01-01' and date(l_receiptdate) < date '1994-01-01' + interval '1' year group by l_shipmode order by l_shipmode LIMIT 1;;100
select c_count, count(*) as custdist from (select c_custkey, count(o_orderkey) as c_count from hive.default.customer_100 c left outer join hive.default.orders_100 o on c.c_custkey = o.o_custkey and not o.o_comment like '%special%requests%' group by c_custkey) c_orders group by c_count order by custdist desc, c_count desc limit 1;;100;select 100.00 * sum(case  when p_type like 'PROMO%'   then l_extendedprice * (1 - l_discount)  else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from hive.default.lineitem_100, hive.default.part_100 where l_partkey = p_partkey and date(l_shipdate) >= date '1994-08-01' and date(l_shipdate) < date '1994-08-01' + interval '1' month LIMIT 1;;100
select s_suppkey, s_name, s_address, s_phone, total_revenue from hive.default.supplier_100, hive.default.revenue_100 where s_suppkey = supplier_no and total_revenue = (  select   max(total_revenue)  from   hive.default.revenue_100 ) order by s_suppkey LIMIT 1;;100;select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from hive.default.partsupp_100, hive.default.part_100 where p_partkey = ps_partkey and p_brand <> 'Brand#21' and p_type not like 'MEDIUM PLATED%' and p_size in (38, 2, 8, 31, 44, 5, 14, 24) and ps_suppkey not in (  select   s_suppkey  from   hive.default.supplier_100  where   s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size LIMIT 1;;100
select sum(l_extendedprice) / 7.0 as avg_yearly from hive.default.lineitem_100, hive.default.part_100, (SELECT l_partkey AS agg_partkey, 0.2 * avg(l_quantity) AS avg_quantity FROM hive.default.lineitem_100 GROUP BY l_partkey) part_agg where p_partkey = l_partkey and agg_partkey = l_partkey and p_brand = 'Brand#13' and p_container = 'JUMBO CAN' and l_quantity < avg_quantity LIMIT 1;;100;select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from hive.default.customer_100, hive.default.orders_100, hive.default.lineitem_100 where o_orderkey in (  select   l_orderkey  from   hive.default.lineitem_100  group by   l_orderkey having    sum(l_quantity) > 300 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate LIMIT 100;;100
select sum(l_extendedprice* (1 - l_discount)) as revenue from hive.default.lineitem_100, hive.default.part_100 where (  p_partkey = l_partkey  and p_brand = 'Brand#41'  and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')  and l_quantity >= 2 and l_quantity <= 2 + 10  and p_size between 1 and 5  and l_shipmode in ('AIR', 'AIR REG')  and l_shipinstruct = 'DELIVER IN PERSON' ) or (  p_partkey = l_partkey  and p_brand = 'Brand#13'  and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')  and l_quantity >= 14 and l_quantity <= 14 + 10  and p_size between 1 and 10  and l_shipmode in ('AIR', 'AIR REG')  and l_shipinstruct = 'DELIVER IN PERSON' ) or (  p_partkey = l_partkey  and p_brand = 'Brand#55'  and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')  and l_quantity >= 23 and l_quantity <= 23 + 10  and p_size between 1 and 15  and l_shipmode in ('AIR', 'AIR REG')  and l_shipinstruct = 'DELIVER IN PERSON' ) LIMIT 1;;100;select s_name, s_address from hive.default.supplier_100, hive.default.nation_100 where s_suppkey in (  select   ps_suppkey  from   hive.default.partsupp_100,   (    select     l_partkey agg_partkey,     l_suppkey agg_suppkey,     0.5 * sum(l_quantity) AS agg_quantity    from     hive.default.lineitem_100    where     date(l_shipdate) >= date '1993-01-01'     and date(l_shipdate) < date '1993-01-01' + interval '1' year    group by     l_partkey,     l_suppkey   ) agg_lineitem  where   agg_partkey = ps_partkey   and agg_suppkey = ps_suppkey   and ps_partkey in (    select     p_partkey    from     hive.default.part_100    where     p_name like 'antique%'   )   and ps_availqty > agg_quantity ) and s_nationkey = n_nationkey and n_name = 'KENYA' order by s_name LIMIT 1;;100
select s_name, count(*) as numwait from hive.default.supplier_100, hive.default.lineitem_100 l1, hive.default.orders_100, hive.default.nation_100 where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists (  select   *  from   hive.default.lineitem_100 l2  where   l2.l_orderkey = l1.l_orderkey   and l2.l_suppkey <> l1.l_suppkey ) and not exists (  select   *  from   hive.default.lineitem_100 l3  where   l3.l_orderkey = l1.l_orderkey   and l3.l_suppkey <> l1.l_suppkey   and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'SAUDI ARABIA' group by s_name order by numwait desc, s_name LIMIT 100;;100;select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from (  select   substring(c_phone, 1, 2) as cntrycode,   c_acctbal  from   hive.default.customer_100  where   substring(c_phone, 1, 2) in    ('13', '31', '23', '29', '30', '18', '17')   and c_acctbal > (    select     avg(c_acctbal)    from     hive.default.customer_100    where     c_acctbal > 0.00     and substring(c_phone, 1, 2) in      ('13', '31', '23', '29', '30', '18', '17')   )   and not exists (    select     *    from     hive.default.orders_100    where     o_custkey = c_custkey   ) ) as custsale group by cntrycode order by cntrycode LIMIT 1;;100
select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from hive.default.lineitem_10 where l_shipdate <= '1998-09-16' group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;;10;select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from hive.default.part_10, hive.default.supplier_10, hive.default.partsupp_10, hive.default.nation_10, hive.default.region_10 where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = (  select   min(ps_supplycost)  from   hive.default.partsupp_10,   hive.default.supplier_10,   hive.default.nation_10,   hive.default.region_10  where   p_partkey = ps_partkey   and s_suppkey = ps_suppkey   and s_nationkey = n_nationkey   and n_regionkey = r_regionkey   and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey LIMIT 100;;10
select l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority from hive.default.customer_10 c join hive.default.orders_10 o on c.c_mktsegment = 'BUILDING' and c.c_custkey = o.o_custkey join hive.default.lineitem_10 l on l.l_orderkey = o.o_orderkey where o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate limit 10;;10;select o_orderpriority, count(*) as order_count from hive.default.orders_10 where date(o_orderdate) >= date '1996-10-01' and date(o_orderdate) < date '1996-10-01' + interval '3' month and exists (  select   *  from   hive.default.lineitem_10  where   l_orderkey = o_orderkey   and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority LIMIT 1;;10
select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from hive.default.customer_10, hive.default.orders_10, hive.default.lineitem_10, hive.default.supplier_10, hive.default.nation_10, hive.default.region_10 where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and date(o_orderdate) >= date '1997-01-01' and date(o_orderdate) < date '1997-01-01' + interval '1' year group by n_name order by revenue desc LIMIT 1;;10;select sum(l_extendedprice * l_discount) as revenue from hive.default.lineitem_10 where date(l_shipdate) >= date '1997-01-01' and date(l_shipdate) < date '1997-01-01' + interval '1' year and l_discount between 0.03 - 0.01 and 0.03 + 0.01 and l_quantity < 24 LIMIT 1;;10
select supp_nation, cust_nation, l_year, sum(volume) as revenue from (  select   n1.n_name as supp_nation,   n2.n_name as cust_nation,   extract(year from date(l_shipdate)) as l_year,   l_extendedprice * (1 - l_discount) as volume  from   hive.default.supplier_10,   hive.default.lineitem_10,   hive.default.orders_10,   hive.default.customer_10,   hive.default.nation_10 n1,   hive.default.nation_10 n2  where   s_suppkey = l_suppkey   and o_orderkey = l_orderkey   and c_custkey = o_custkey   and s_nationkey = n1.n_nationkey   and c_nationkey = n2.n_nationkey   and (    (n1.n_name = 'EGYPT' and n2.n_name = 'UNITED STATES')    or (n1.n_name = 'UNITED STATES' and n2.n_name = 'EGYPT')   )   and date(l_shipdate) between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year LIMIT 1;;10;select o_year, sum(case  when nation = 'EGYPT' then volume  else 0 end) / sum(volume) as mkt_share from (  select   extract(year from date(o_orderdate)) as o_year,   l_extendedprice * (1 - l_discount) as volume,   n2.n_name as nation  from   hive.default.part_10,   hive.default.supplier_10,   hive.default.lineitem_10,   hive.default.orders_10,   hive.default.customer_10,   hive.default.nation_10 n1,   hive.default.nation_10 n2,   hive.default.region_10  where   p_partkey = l_partkey   and s_suppkey = l_suppkey   and l_orderkey = o_orderkey   and o_custkey = c_custkey   and c_nationkey = n1.n_nationkey   and n1.n_regionkey = r_regionkey   and r_name = 'MIDDLE EAST'   and s_nationkey = n2.n_nationkey   and date(o_orderdate) between date '1995-01-01' and date '1996-12-31'   and p_type = 'PROMO BRUSHED COPPER' ) as all_nations group by o_year order by o_year LIMIT 1;;10
select nation, o_year, sum(amount) as sum_profit from (  select   n_name as nation,   extract(year from date(o_orderdate)) as o_year,   l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount  from   hive.default.part_10,   hive.default.supplier_10,   hive.default.lineitem_10,   hive.default.partsupp_10,   hive.default.orders_10,   hive.default.nation_10  where   s_suppkey = l_suppkey   and ps_suppkey = l_suppkey   and ps_partkey = l_partkey   and p_partkey = l_partkey   and o_orderkey = l_orderkey   and s_nationkey = n_nationkey   and p_name like '%yellow%' ) as profit group by nation, o_year order by nation, o_year desc LIMIT 1;;10;select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from hive.default.customer_10, hive.default.orders_10, hive.default.lineitem_10, hive.default.nation_10 where c_custkey = o_custkey and l_orderkey = o_orderkey and date(o_orderdate) >= date '1994-03-01' and date(o_orderdate) < date '1994-03-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc LIMIT 20;;10
select ps_partkey, sum(ps_supplycost * ps_availqty) as value from hive.default.partsupp_10, hive.default.supplier_10, hive.default.nation_10 where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'JAPAN' group by ps_partkey having  sum(ps_supplycost * ps_availqty) > (   select    sum(ps_supplycost * ps_availqty) * 0.0001   from    hive.default.partsupp_10,    hive.default.supplier_10,    hive.default.nation_10   where    ps_suppkey = s_suppkey    and s_nationkey = n_nationkey    and n_name = 'JAPAN'  ) order by value desc LIMIT 1;;10;select l_shipmode, sum(case  when o_orderpriority = '1-URGENT'   or o_orderpriority = '2-HIGH'   then 1  else 0 end) as high_line_count, sum(case  when o_orderpriority <> '1-URGENT'   and o_orderpriority <> '2-HIGH'   then 1  else 0 end) as low_line_count from hive.default.orders_10, hive.default.lineitem_10 where o_orderkey = l_orderkey and l_shipmode in ('TRUCK', 'REG AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and date(l_receiptdate) >= date '1994-01-01' and date(l_receiptdate) < date '1994-01-01' + interval '1' year group by l_shipmode order by l_shipmode LIMIT 1;;10
select c_count, count(*) as custdist from (select c_custkey, count(o_orderkey) as c_count from hive.default.customer_10 c left outer join hive.default.orders_10 o on c.c_custkey = o.o_custkey and not o.o_comment like '%special%requests%' group by c_custkey) c_orders group by c_count order by custdist desc, c_count desc limit 1;;10;select 100.00 * sum(case  when p_type like 'PROMO%'   then l_extendedprice * (1 - l_discount)  else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from hive.default.lineitem_10, hive.default.part_10 where l_partkey = p_partkey and date(l_shipdate) >= date '1994-08-01' and date(l_shipdate) < date '1994-08-01' + interval '1' month LIMIT 1;;10
select s_suppkey, s_name, s_address, s_phone, total_revenue from hive.default.supplier_10, hive.default.revenue_10 where s_suppkey = supplier_no and total_revenue = (  select   max(total_revenue)  from   hive.default.revenue_10 ) order by s_suppkey LIMIT 1;;10;select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from hive.default.partsupp_10, hive.default.part_10 where p_partkey = ps_partkey and p_brand <> 'Brand#21' and p_type not like 'MEDIUM PLATED%' and p_size in (38, 2, 8, 31, 44, 5, 14, 24) and ps_suppkey not in (  select   s_suppkey  from   hive.default.supplier_10  where   s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size LIMIT 1;;10
select sum(l_extendedprice) / 7.0 as avg_yearly from hive.default.lineitem_10, hive.default.part_10, (SELECT l_partkey AS agg_partkey, 0.2 * avg(l_quantity) AS avg_quantity FROM hive.default.lineitem_10 GROUP BY l_partkey) part_agg where p_partkey = l_partkey and agg_partkey = l_partkey and p_brand = 'Brand#13' and p_container = 'JUMBO CAN' and l_quantity < avg_quantity LIMIT 1;;10;select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from hive.default.customer_10, hive.default.orders_10, hive.default.lineitem_10 where o_orderkey in (  select   l_orderkey  from   hive.default.lineitem_10  group by   l_orderkey having    sum(l_quantity) > 300 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate LIMIT 100;;10
select sum(l_extendedprice* (1 - l_discount)) as revenue from hive.default.lineitem_10, hive.default.part_10 where (  p_partkey = l_partkey  and p_brand = 'Brand#41'  and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')  and l_quantity >= 2 and l_quantity <= 2 + 10  and p_size between 1 and 5  and l_shipmode in ('AIR', 'AIR REG')  and l_shipinstruct = 'DELIVER IN PERSON' ) or (  p_partkey = l_partkey  and p_brand = 'Brand#13'  and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')  and l_quantity >= 14 and l_quantity <= 14 + 10  and p_size between 1 and 10  and l_shipmode in ('AIR', 'AIR REG')  and l_shipinstruct = 'DELIVER IN PERSON' ) or (  p_partkey = l_partkey  and p_brand = 'Brand#55'  and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')  and l_quantity >= 23 and l_quantity <= 23 + 10  and p_size between 1 and 15  and l_shipmode in ('AIR', 'AIR REG')  and l_shipinstruct = 'DELIVER IN PERSON' ) LIMIT 1;;10;select s_name, s_address from hive.default.supplier_10, hive.default.nation_10 where s_suppkey in (  select   ps_suppkey  from   hive.default.partsupp_10,   (    select     l_partkey agg_partkey,     l_suppkey agg_suppkey,     0.5 * sum(l_quantity) AS agg_quantity    from     hive.default.lineitem_10    where     date(l_shipdate) >= date '1993-01-01'     and date(l_shipdate) < date '1993-01-01' + interval '1' year    group by     l_partkey,     l_suppkey   ) agg_lineitem  where   agg_partkey = ps_partkey   and agg_suppkey = ps_suppkey   and ps_partkey in (    select     p_partkey    from     hive.default.part_10    where     p_name like 'antique%'   )   and ps_availqty > agg_quantity ) and s_nationkey = n_nationkey and n_name = 'KENYA' order by s_name LIMIT 1;;10
select s_name, count(*) as numwait from hive.default.supplier_10, hive.default.lineitem_10 l1, hive.default.orders_10, hive.default.nation_10 where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists (  select   *  from   hive.default.lineitem_10 l2  where   l2.l_orderkey = l1.l_orderkey   and l2.l_suppkey <> l1.l_suppkey ) and not exists (  select   *  from   hive.default.lineitem_10 l3  where   l3.l_orderkey = l1.l_orderkey   and l3.l_suppkey <> l1.l_suppkey   and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'SAUDI ARABIA' group by s_name order by numwait desc, s_name LIMIT 100;;10;select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from (  select   substring(c_phone, 1, 2) as cntrycode,   c_acctbal  from   hive.default.customer_10  where   substring(c_phone, 1, 2) in    ('13', '31', '23', '29', '30', '18', '17')   and c_acctbal > (    select     avg(c_acctbal)    from     hive.default.customer_10    where     c_acctbal > 0.00     and substring(c_phone, 1, 2) in      ('13', '31', '23', '29', '30', '18', '17')   )   and not exists (    select     *    from     hive.default.orders_10    where     o_custkey = c_custkey   ) ) as custsale group by cntrycode order by cntrycode LIMIT 1;;10
select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from hive.default.lineitem_300 where l_shipdate <= '1998-09-16' group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus;;300;select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from hive.default.part_300, hive.default.supplier_300, hive.default.partsupp_300, hive.default.nation_300, hive.default.region_300 where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = (  select   min(ps_supplycost)  from   hive.default.partsupp_300,   hive.default.supplier_300,   hive.default.nation_300,   hive.default.region_300  where   p_partkey = ps_partkey   and s_suppkey = ps_suppkey   and s_nationkey = n_nationkey   and n_regionkey = r_regionkey   and r_name = 'EUROPE' ) order by s_acctbal desc, n_name, s_name, p_partkey LIMIT 100;;300
select l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority from hive.default.customer_300 c join hive.default.orders_300 o on c.c_mktsegment = 'BUILDING' and c.c_custkey = o.o_custkey join hive.default.lineitem_300 l on l.l_orderkey = o.o_orderkey where o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate limit 10;;300;select o_orderpriority, count(*) as order_count from hive.default.orders_300 where date(o_orderdate) >= date '1996-10-01' and date(o_orderdate) < date '1996-10-01' + interval '3' month and exists (  select   *  from   hive.default.lineitem_300  where   l_orderkey = o_orderkey   and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority LIMIT 1;;300
select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from hive.default.customer_300, hive.default.orders_300, hive.default.lineitem_300, hive.default.supplier_300, hive.default.nation_300, hive.default.region_300 where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and date(o_orderdate) >= date '1997-01-01' and date(o_orderdate) < date '1997-01-01' + interval '1' year group by n_name order by revenue desc LIMIT 1;;300;select sum(l_extendedprice * l_discount) as revenue from hive.default.lineitem_300 where date(l_shipdate) >= date '1997-01-01' and date(l_shipdate) < date '1997-01-01' + interval '1' year and l_discount between 0.03 - 0.01 and 0.03 + 0.01 and l_quantity < 24 LIMIT 1;;300
select supp_nation, cust_nation, l_year, sum(volume) as revenue from (  select   n1.n_name as supp_nation,   n2.n_name as cust_nation,   extract(year from date(l_shipdate)) as l_year,   l_extendedprice * (1 - l_discount) as volume  from   hive.default.supplier_300,   hive.default.lineitem_300,   hive.default.orders_300,   hive.default.customer_300,   hive.default.nation_300 n1,   hive.default.nation_300 n2  where   s_suppkey = l_suppkey   and o_orderkey = l_orderkey   and c_custkey = o_custkey   and s_nationkey = n1.n_nationkey   and c_nationkey = n2.n_nationkey   and (    (n1.n_name = 'EGYPT' and n2.n_name = 'UNITED STATES')    or (n1.n_name = 'UNITED STATES' and n2.n_name = 'EGYPT')   )   and date(l_shipdate) between date '1995-01-01' and date '1996-12-31' ) as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year LIMIT 1;;300;select o_year, sum(case  when nation = 'EGYPT' then volume  else 0 end) / sum(volume) as mkt_share from (  select   extract(year from date(o_orderdate)) as o_year,   l_extendedprice * (1 - l_discount) as volume,   n2.n_name as nation  from   hive.default.part_300,   hive.default.supplier_300,   hive.default.lineitem_300,   hive.default.orders_300,   hive.default.customer_300,   hive.default.nation_300 n1,   hive.default.nation_300 n2,   hive.default.region_300  where   p_partkey = l_partkey   and s_suppkey = l_suppkey   and l_orderkey = o_orderkey   and o_custkey = c_custkey   and c_nationkey = n1.n_nationkey   and n1.n_regionkey = r_regionkey   and r_name = 'MIDDLE EAST'   and s_nationkey = n2.n_nationkey   and date(o_orderdate) between date '1995-01-01' and date '1996-12-31'   and p_type = 'PROMO BRUSHED COPPER' ) as all_nations group by o_year order by o_year LIMIT 1;;300
select nation, o_year, sum(amount) as sum_profit from (  select   n_name as nation,   extract(year from date(o_orderdate)) as o_year,   l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount  from   hive.default.part_300,   hive.default.supplier_300,   hive.default.lineitem_300,   hive.default.partsupp_300,   hive.default.orders_300,   hive.default.nation_300  where   s_suppkey = l_suppkey   and ps_suppkey = l_suppkey   and ps_partkey = l_partkey   and p_partkey = l_partkey   and o_orderkey = l_orderkey   and s_nationkey = n_nationkey   and p_name like '%yellow%' ) as profit group by nation, o_year order by nation, o_year desc LIMIT 1;;300;select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from hive.default.customer_300, hive.default.orders_300, hive.default.lineitem_300, hive.default.nation_300 where c_custkey = o_custkey and l_orderkey = o_orderkey and date(o_orderdate) >= date '1994-03-01' and date(o_orderdate) < date '1994-03-01' + interval '3' month and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc LIMIT 20;;300
select ps_partkey, sum(ps_supplycost * ps_availqty) as value from hive.default.partsupp_300, hive.default.supplier_300, hive.default.nation_300 where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'JAPAN' group by ps_partkey having  sum(ps_supplycost * ps_availqty) > (   select    sum(ps_supplycost * ps_availqty) * 0.0001   from    hive.default.partsupp_300,    hive.default.supplier_300,    hive.default.nation_300   where    ps_suppkey = s_suppkey    and s_nationkey = n_nationkey    and n_name = 'JAPAN'  ) order by value desc LIMIT 1;;300;select l_shipmode, sum(case  when o_orderpriority = '1-URGENT'   or o_orderpriority = '2-HIGH'   then 1  else 0 end) as high_line_count, sum(case  when o_orderpriority <> '1-URGENT'   and o_orderpriority <> '2-HIGH'   then 1  else 0 end) as low_line_count from hive.default.orders_300, hive.default.lineitem_300 where o_orderkey = l_orderkey and l_shipmode in ('TRUCK', 'REG AIR') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and date(l_receiptdate) >= date '1994-01-01' and date(l_receiptdate) < date '1994-01-01' + interval '1' year group by l_shipmode order by l_shipmode LIMIT 1;;300
select c_count, count(*) as custdist from (select c_custkey, count(o_orderkey) as c_count from hive.default.customer_300 c left outer join hive.default.orders_300 o on c.c_custkey = o.o_custkey and not o.o_comment like '%special%requests%' group by c_custkey) c_orders group by c_count order by custdist desc, c_count desc limit 1;;300;select 100.00 * sum(case  when p_type like 'PROMO%'   then l_extendedprice * (1 - l_discount)  else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from hive.default.lineitem_300, hive.default.part_300 where l_partkey = p_partkey and date(l_shipdate) >= date '1994-08-01' and date(l_shipdate) < date '1994-08-01' + interval '1' month LIMIT 1;;300
select s_suppkey, s_name, s_address, s_phone, total_revenue from hive.default.supplier_300, hive.default.revenue_300 where s_suppkey = supplier_no and total_revenue = (  select   max(total_revenue)  from   hive.default.revenue_300 ) order by s_suppkey LIMIT 1;;300;select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from hive.default.partsupp_300, hive.default.part_300 where p_partkey = ps_partkey and p_brand <> 'Brand#21' and p_type not like 'MEDIUM PLATED%' and p_size in (38, 2, 8, 31, 44, 5, 14, 24) and ps_suppkey not in (  select   s_suppkey  from   hive.default.supplier_300  where   s_comment like '%Customer%Complaints%' ) group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size LIMIT 1;;300
select sum(l_extendedprice) / 7.0 as avg_yearly from hive.default.lineitem_300, hive.default.part_300, (SELECT l_partkey AS agg_partkey, 0.2 * avg(l_quantity) AS avg_quantity FROM hive.default.lineitem_300 GROUP BY l_partkey) part_agg where p_partkey = l_partkey and agg_partkey = l_partkey and p_brand = 'Brand#13' and p_container = 'JUMBO CAN' and l_quantity < avg_quantity LIMIT 1;;300;select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from hive.default.customer_300, hive.default.orders_300, hive.default.lineitem_300 where o_orderkey in (  select   l_orderkey  from   hive.default.lineitem_300  group by   l_orderkey having    sum(l_quantity) > 300 ) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate LIMIT 100;;300
select sum(l_extendedprice* (1 - l_discount)) as revenue from hive.default.lineitem_300, hive.default.part_300 where (  p_partkey = l_partkey  and p_brand = 'Brand#41'  and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')  and l_quantity >= 2 and l_quantity <= 2 + 10  and p_size between 1 and 5  and l_shipmode in ('AIR', 'AIR REG')  and l_shipinstruct = 'DELIVER IN PERSON' ) or (  p_partkey = l_partkey  and p_brand = 'Brand#13'  and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')  and l_quantity >= 14 and l_quantity <= 14 + 10  and p_size between 1 and 10  and l_shipmode in ('AIR', 'AIR REG')  and l_shipinstruct = 'DELIVER IN PERSON' ) or (  p_partkey = l_partkey  and p_brand = 'Brand#55'  and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')  and l_quantity >= 23 and l_quantity <= 23 + 10  and p_size between 1 and 15  and l_shipmode in ('AIR', 'AIR REG')  and l_shipinstruct = 'DELIVER IN PERSON' ) LIMIT 1;;300;select s_name, s_address from hive.default.supplier_300, hive.default.nation_300 where s_suppkey in (  select   ps_suppkey  from   hive.default.partsupp_300,   (    select     l_partkey agg_partkey,     l_suppkey agg_suppkey,     0.5 * sum(l_quantity) AS agg_quantity    from     hive.default.lineitem_300    where     date(l_shipdate) >= date '1993-01-01'     and date(l_shipdate) < date '1993-01-01' + interval '1' year    group by     l_partkey,     l_suppkey   ) agg_lineitem  where   agg_partkey = ps_partkey   and agg_suppkey = ps_suppkey   and ps_partkey in (    select     p_partkey    from     hive.default.part_300    where     p_name like 'antique%'   )   and ps_availqty > agg_quantity ) and s_nationkey = n_nationkey and n_name = 'KENYA' order by s_name LIMIT 1;;300
select s_name, count(*) as numwait from hive.default.supplier_300, hive.default.lineitem_300 l1, hive.default.orders_300, hive.default.nation_300 where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists (  select   *  from   hive.default.lineitem_300 l2  where   l2.l_orderkey = l1.l_orderkey   and l2.l_suppkey <> l1.l_suppkey ) and not exists (  select   *  from   hive.default.lineitem_300 l3  where   l3.l_orderkey = l1.l_orderkey   and l3.l_suppkey <> l1.l_suppkey   and l3.l_receiptdate > l3.l_commitdate ) and s_nationkey = n_nationkey and n_name = 'SAUDI ARABIA' group by s_name order by numwait desc, s_name LIMIT 100;;300;select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from (  select   substring(c_phone, 1, 2) as cntrycode,   c_acctbal  from   hive.default.customer_300  where   substring(c_phone, 1, 2) in    ('13', '31', '23', '29', '30', '18', '17')   and c_acctbal > (    select     avg(c_acctbal)    from     hive.default.customer_300    where     c_acctbal > 0.00     and substring(c_phone, 1, 2) in      ('13', '31', '23', '29', '30', '18', '17')   )   and not exists (    select     *    from     hive.default.orders_300    where     o_custkey = c_custkey   ) ) as custsale group by cntrycode order by cntrycode LIMIT 1;;300
